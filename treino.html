<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treino - Clarity</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="treino.css">
</head>
<body>

    <!-- MENU LATERAL (drawer) -->
    <div class="drawer-overlay" id="drawerOverlay" onclick="closeDrawer()"></div>
    <aside class="side-drawer" id="sideDrawer">
        <div class="drawer-header">
            <span class="drawer-title">treino</span>
            <button class="drawer-close" onclick="closeDrawer()">‚úï</button>
        </div>
        <nav class="drawer-nav">
            <button class="drawer-item drawer-item--active" id="dItemPlanos"   onclick="setView('planos')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
                meus planos
            </button>
            <button class="drawer-item" id="dItemRegistro" onclick="setView('registro')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4z"/></svg>
                registrar treino
            </button>
            <button class="drawer-item" id="dItemStats"    onclick="setView('stats')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                estat√≠sticas
            </button>
            <button class="drawer-item" id="dItemMedidas"  onclick="setView('medidas')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"/><path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"/></svg>
                medidas corporais
            </button>
        </nav>
        <div class="drawer-footer">
            <button class="btn-topbar-action" onclick="exportTreino()" style="width:100%;justify-content:center;gap:8px;border-radius:12px">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                exportar dados
            </button>
        </div>
    </aside>

    <!-- TOPBAR -->
    <div class="treino-topbar">
        <button class="drawer-trigger" onclick="openDrawer()" id="drawerBtn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/>
            </svg>
        </button>
        <div class="treino-topbar-center">
            <div class="treino-date-nav">
                <button class="nav-btn" onclick="changeDate(-1)">‚Äπ</button>
                <div class="date-nav-center">
                    <div id="treinoDateTitle" onclick="toggleDatePicker()" style="cursor:pointer" title="clique para escolher data">...</div>
                    <button class="today-btn hidden" id="todayBtn" onclick="goToToday()">hoje</button>
                </div>
                <button class="nav-btn" onclick="changeDate(1)">‚Ä∫</button>
            </div>
            <!-- Mini calend√°rio -->
            <div class="date-picker-popup hidden" id="datePicker">
                <div class="dp-header">
                    <button class="dp-nav" onclick="dpPrevMonth()">‚Äπ</button>
                    <span id="dpMonthLabel"></span>
                    <button class="dp-nav" onclick="dpNextMonth()">‚Ä∫</button>
                </div>
                <div class="dp-grid" id="dpGrid"></div>
            </div>
            <div class="treino-view-label" id="treinoViewLabel">planos</div>
        </div>
        <button class="theme-toggle" onclick="toggleTheme()" id="themeToggleBtn">‚òÄ claro</button>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PLANOS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="viewPlanos" class="treino-page">
        <div class="plans-wrapper" id="plansWrapper">
            <!-- Estado: centralizado (s√≥ lista) -->
            <div class="plans-center-panel glass-panel" id="plansCenterPanel">
                <div class="plans-header">
                    <span class="plans-title">meus planos de treino</span>
                    <button class="btn-new-plan" onclick="openNewPlan()">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                        novo plano
                    </button>
                </div>
                <div id="plansList" class="plans-list-body"></div>
            </div>

            <!-- Editor (aparece √† direita) -->
            <div class="plan-editor-card glass-panel" id="planEditor" style="display:none">
                <div class="plan-editor-header">
                    <input type="text" id="planNameInput" class="f-input plan-name-input" placeholder="nome do plano (ex: Treino A)">
                    <div class="plan-editor-actions">
                        <button class="btn-del-plan" id="btnDelPlan" onclick="deletePlan()" style="display:none">apagar</button>
                        <button class="btn-save-plan" onclick="savePlanEdit()">‚úì salvar</button>
                        <button class="plan-editor-close" onclick="closePlanEditor()" title="Fechar">‚úï</button>
                    </div>
                </div>
                <div id="planMuscleGroups" class="plan-muscle-groups"></div>
                <div class="plan-add-ex-form">
                    <div class="pae-title">adicionar exerc√≠cio</div>
                    <div class="pae-with-preview">
                        <div class="pae-form-fields">
                            <!-- Avatar muscular interativo -->
                            <div class="muscle-avatar-selector">
                                <div class="muscle-avatar-label">selecione o m√∫sculo clicando no avatar:</div>
                                <div class="muscle-avatar-main-row">
                                <div class="muscle-avatars-row">
                                    <div class="avatar-wrap">
                                        <div class="avatar-side-label">frente</div>
                                        <div class="avatar-img-wrap">
                                            <img src="avatar_front.png" class="avatar-img" alt="frente">
                                            <svg class="avatar-overlay" viewBox="0 0 587 864" xmlns="http://www.w3.org/2000/svg">
                                                <polygon class="muscle-zone" data-muscle="Peito"       points="175,200 385,200 385,270 280,280 175,270"/>
                                                <polygon class="muscle-zone" data-muscle="Ombro"       points="155,165 220,165 200,225 155,225"/>
                                                <polygon class="muscle-zone" data-muscle="Ombro"       points="366,165 432,165 432,225 397,225"/>
                                                <polygon class="muscle-zone" data-muscle="B√≠ceps"      points="125,225 186,225 170,355 124,355"/>
                                                <polygon class="muscle-zone" data-muscle="B√≠ceps"      points="374,225 436,225 436,355 393,355"/>
                                                <polygon class="muscle-zone" data-muscle="Antebra√ßo"   points="124,355 167,355 137,450 103,450"/>
                                                <polygon class="muscle-zone" data-muscle="Antebra√ßo"   points="393,355 436,355 456,450 422,450"/>
                                                <polygon class="muscle-zone" data-muscle="Abd√¥men"     points="215,270 345,270 366,460 197,460"/>
                                                <polygon class="muscle-zone" data-muscle="Quadr√≠ceps"  points="197,460 266,460 261,648 203,648"/>
                                                <polygon class="muscle-zone" data-muscle="Quadr√≠ceps"  points="301,460 366,460 368,648 312,648"/>
                                                <polygon class="muscle-zone" data-muscle="Panturrilha" points="204,658 261,658 245,785 211,785"/>
                                                <polygon class="muscle-zone" data-muscle="Panturrilha" points="312,658 367,658 364,785 330,785"/>
                                            </svg>
                                        </div>
                                    </div>
                                    <div class="avatar-wrap">
                                        <div class="avatar-side-label">costas</div>
                                        <div class="avatar-img-wrap">
                                            <img src="avatar_back.png" class="avatar-img" alt="costas">
                                            <svg class="avatar-overlay" viewBox="0 0 587 864" xmlns="http://www.w3.org/2000/svg">
                                                <polygon class="muscle-zone" data-muscle="Costas"      points="189,165 414,165 369,370 235,370"/>
                                                <polygon class="muscle-zone" data-muscle="Ombro"       points="150,160 210,165 210,230 160,230"/>
                                                <polygon class="muscle-zone" data-muscle="Ombro"       points="380,165 440,160 432,230 380,230"/>
                                                <polygon class="muscle-zone" data-muscle="Tr√≠ceps"     points="150,225 210,225 174,375 139,375"/>
                                                <polygon class="muscle-zone" data-muscle="Tr√≠ceps"     points="380,225 440,225 465,375 429,375"/>
                                                <polygon class="muscle-zone" data-muscle="Antebra√ßo"   points="139,375 170,375 154,455 132,455"/>
                                                <polygon class="muscle-zone" data-muscle="Antebra√ßo"   points="429,375 465,375 473,455 451,455"/>
                                                <polygon class="muscle-zone" data-muscle="Gl√∫teo"      points="220,370 368,370 385,470 216,470"/>
                                                <polygon class="muscle-zone" data-muscle="Posterior"   points="216,475 281,475 271,650 215,650"/>
                                                <polygon class="muscle-zone" data-muscle="Posterior"   points="317,475 380,475 380,650 324,650"/>
                                                <polygon class="muscle-zone" data-muscle="Panturrilha" points="215,658 271,658 251,785 222,785"/>
                                                <polygon class="muscle-zone" data-muscle="Panturrilha" points="323,658 380,658 370,785 341,785"/>
                                            </svg>
                                        </div>
                                    </div>
                                </div>

                                </div><!-- end muscle-avatar-main-row -->
                                <div class="muscle-selected-display">
                                    <span class="muscle-selected-label">selecionado:</span>
                                    <span class="muscle-selected-name" id="muscleSelectedName">clique no avatar</span>
                                </div>
                                <input type="hidden" id="paeMusc" value="">
                            </div>
                            <div class="ef-row-top">
                                <select id="paeEx" class="f-select" style="flex:1" onchange="updatePaePreview()"><option value="">‚Äî exerc√≠cio ‚Äî</option></select>
                                <input type="text" id="paeExCustom" class="f-input hidden" placeholder="nome do exerc√≠cio" style="flex:1">
                            </div>
                            <div class="ef-row-top" style="margin-top:6px">
                                <div class="equip-toggle">
                                    <button class="equip-btn equip-btn--active" id="paeBtnLivre"   onclick="setPaeEquip('livre')">üèãÔ∏è livre</button>
                                    <button class="equip-btn"                   id="paeBtnMaquina" onclick="setPaeEquip('maquina')">‚öôÔ∏è m√°quina</button>
                                </div>
                                <input type="text" id="paeObs" class="f-input" placeholder="observa√ß√£o" style="flex:1">
                                <button class="btn-add-set" onclick="addExToPlan()">+ add</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê REGISTRO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="viewRegistro" class="treino-page hidden">
        <div class="registro-grid">
            <!-- Coluna principal -->
            <div class="registro-main">
                <!-- Stats do dia -->
                <div class="reg-stats-row" id="treinoStatsRow"></div>

                <!-- For√ßa comparada (animal do dia) -->
                <div class="glass-panel reg-animal-panel" id="regAnimalPanel" style="display:none"></div>

                <!-- Seletor de plano -->
                <div class="glass-panel plan-day-selector">
                    <div class="pds-label">qual treino voc√™ realizou hoje?</div>
                    <div class="pds-plans-row" id="pdsPlansList"></div>
                    <div class="pds-divider">ou</div>
                    <button class="btn-cardio-toggle" id="btnCardioToggle" onclick="toggleCardioForm()">
                        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                        cardio / outro
                    </button>
                </div>

                <!-- Exerc√≠cios do plano -->
                <div id="planExercisesForm" style="display:none">
                    <div class="glass-panel pef-header-panel">
                        <div>
                            <span class="pef-plan-name" id="pefPlanName"></span>
                            <span class="pef-subtitle">registre a carga de cada exerc√≠cio</span>
                        </div>
                        <button class="btn-discard" onclick="cancelPlanSelection()">cancelar</button>
                    </div>
                    <div id="pefExercisesAccordion"></div>
                    <button class="btn-save-session" onclick="saveSession()">‚úì salvar sess√£o</button>
                </div>

                <!-- Cardio -->
                <div class="exercise-form glass-panel hidden" id="formCardio">
                    <div class="form-title">registrar cardio / atividade</div>
                    <div class="ef-row-top">
                        <input type="text" id="cfActivity" class="f-input" placeholder="atividade (corrida, nata√ß√£o, yoga‚Ä¶)" style="flex:1">
                    </div>
                    <div class="ef-row-add">
                        <div class="ef-add-field">
                            <label class="ef-add-label">dura√ß√£o (min)</label>
                            <input type="number" id="cfDuration" class="f-input ef-num-input" min="0" step="1" placeholder="30">
                        </div>
                        <div class="ef-add-field">
                            <label class="ef-add-label">dist√¢ncia (km)</label>
                            <input type="number" id="cfDistance" class="f-input ef-num-input" min="0" step="0.1" placeholder="0">
                        </div>
                        <div class="ef-add-field">
                            <label class="ef-add-label">intensidade</label>
                            <select id="cfIntensity" class="f-select"><option value="leve">leve</option><option value="moderada" selected>moderada</option><option value="intensa">intensa</option></select>
                        </div>
                    </div>
                    <div class="ef-row-top">
                        <input type="text" id="cfObs" class="f-input" placeholder="observa√ß√µes" style="flex:1">
                        <button class="btn-save-exercise" style="width:auto;padding:11px 22px" onclick="saveCardio()">‚úì salvar</button>
                    </div>
                </div>

                <!-- Lista do dia -->
                <div class="exercises-list-panel glass-panel">
                    <div class="exercises-list-header">
                        <div class="form-title" id="exercisesListTitle">exerc√≠cios do dia</div>
                        <button class="btn-del-session hidden" id="btnDelSession" onclick="deleteSession()">üóë apagar treino</button>
                    </div>
                    <div id="exercisesList"></div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="registro-sidebar">
                <div class="glass-panel progress-chart-panel">
                    <div class="pcp-header">
                        <span class="pcp-title">progress√£o de carga</span>
                        <select id="chartExerciseSel" class="f-select pcp-sel" onchange="renderProgressChart()">
                            <option value="">selecione um exerc√≠cio</option>
                        </select>
                    </div>
                    <div class="pcp-chart-wrap"><canvas id="progressChart"></canvas></div>
                    <div class="pcp-pr" id="pcpPR"></div>
                </div>
                <div class="glass-panel recent-history-panel">
                    <div class="rhp-title">hist√≥rico recente</div>
                    <div id="recentHistoryList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ESTAT√çSTICAS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="viewStats" class="treino-page hidden treino-stats-view">
        <div class="stats-outer-grid">
            <div class="glass-panel stats-panel">
                <div class="stats-panel-title">s√©ries por m√∫sculo ‚Äî √∫ltimos 7 dias</div>
                <div id="statsMuscleList"></div>
            </div>
            <div class="glass-panel stats-panel">
                <div class="stats-panel-title">frequ√™ncia ‚Äî √∫ltimas 4 semanas</div>
                <div class="stats-chart-wrap"><canvas id="statsFreqChart"></canvas></div>
            </div>
            <!-- Calend√°rio naveg√°vel com bot√µes de m√™s -->
            <div class="glass-panel stats-panel stats-panel--wide">
                <div class="stats-panel-title">
                    calend√°rio de treinos üìÖ
                    <div class="cal-nav-row">
                        <button class="cal-nav-btn" onclick="calPrevMonth()">‚Äπ</button>
                        <span id="calMonthLabel">‚Äî</span>
                        <button class="cal-nav-btn" onclick="calNextMonth()">‚Ä∫</button>
                    </div>
                </div>
                <div id="statsCalendar" class="stats-calendar-single"></div>
            </div>
            <div class="glass-panel stats-panel">
                <div class="stats-panel-title">resumo ‚Äî √∫ltimos 30 dias</div>
                <div id="statsSummary" class="stats-summary-list"></div>
            </div>
            <div class="glass-panel stats-panel">
                <div class="stats-panel-title">for√ßa comparada (todos os treinos) ü¶Å</div>
                <div id="statsAnimals"></div>
            </div>
            <div class="glass-panel stats-panel stats-panel--wide">
                <div class="stats-panel-title">recordes de carga por exerc√≠cio üèÜ</div>
                <div id="statsPRList" class="stats-pr-list"></div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MEDIDAS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="viewMedidas" class="treino-page hidden">
        <div class="medidas-container">
            <div class="glass-panel medidas-form-panel">
                <div class="stats-panel-title" style="margin-bottom:14px">registrar medidas corporais</div>
                <div class="medidas-form-grid">
                    <div class="mf-field"><label class="ef-add-label">data</label><input type="date" id="mDate" class="f-input"></div>
                    <div class="mf-field"><label class="ef-add-label">peso (kg)</label><input type="number" id="mPeso" class="f-input ef-num-input" step="0.1" placeholder="‚Äî"></div>
                    <div class="mf-field"><label class="ef-add-label">altura (cm)</label><input type="number" id="mAltura" class="f-input ef-num-input" step="0.5" placeholder="‚Äî"></div>
                    <div class="mf-field"><label class="ef-add-label">peito (cm)</label><input type="number" id="mPeito" class="f-input ef-num-input" step="0.5" placeholder="‚Äî"></div>
                    <div class="mf-field"><label class="ef-add-label">cintura (cm)</label><input type="number" id="mCintura" class="f-input ef-num-input" step="0.5" placeholder="‚Äî"></div>
                    <div class="mf-field"><label class="ef-add-label">quadril (cm)</label><input type="number" id="mQuadril" class="f-input ef-num-input" step="0.5" placeholder="‚Äî"></div>
                    <div class="mf-field"><label class="ef-add-label">b√≠ceps (cm)</label><input type="number" id="mBiceps" class="f-input ef-num-input" step="0.5" placeholder="‚Äî"></div>
                    <div class="mf-field"><label class="ef-add-label">coxa (cm)</label><input type="number" id="mCoxa" class="f-input ef-num-input" step="0.5" placeholder="‚Äî"></div>
                    <div class="mf-field"><label class="ef-add-label">% gordura</label><input type="number" id="mGordura" class="f-input ef-num-input" step="0.1" placeholder="‚Äî"></div>
                </div>
                <button class="btn-save-exercise" onclick="saveMedida()">‚úì registrar medidas</button>
            </div>
            <div class="glass-panel stats-panel">
                <div class="stats-panel-title">evolu√ß√£o do peso</div>
                <div class="stats-chart-wrap" style="height:200px"><canvas id="medidasPesoChart"></canvas></div>
            </div>
            <div class="glass-panel stats-panel">
                <div class="stats-panel-title">primeira vs. √∫ltima medi√ß√£o</div>
                <div id="medidasDiff" class="stats-summary-list"></div>
            </div>
            <div class="glass-panel stats-panel stats-panel--wide">
                <div class="stats-panel-title">hist√≥rico de medidas</div>
                <div id="medidasTable" class="medidas-table"></div>
            </div>
        </div>
    </div>

    <!-- MODAL: detalhes do dia no calend√°rio -->
    <div class="cal-day-overlay" id="calDayOverlay" onclick="closeCalDayModal(event)">
        <div class="cal-day-modal">
            <div class="cal-day-modal-header">
                <div class="cal-day-modal-date" id="calDayDate">‚Äî</div>
                <button class="cal-day-modal-close" onclick="closeCalDayModal()">‚úï</button>
            </div>
            <div id="calDayContent" class="cal-day-content"></div>
        </div>
    </div>

    <!-- MENU FLUTUANTE -->
    <nav class="float-nav">
        <a href="index.html" class="fn-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/></svg><span>h√°bitos</span></a>
        <a href="nutricao.html" class="fn-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2.69l5.66 5.66a8 8 0 11-11.31 0z"/></svg><span>nutri√ß√£o</span></a>
        <a href="estudos.html" class="fn-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/><path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/></svg><span>estudos</span></a>
        <a href="treino.html" class="fn-btn fn-btn--active"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 6.5h11M6.5 17.5h11M3 12h3m15 0h-3M6 9l-3 3 3 3M18 9l3 3-3 3"/></svg><span>treino</span></a>
        <a href="notas.html" class="fn-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg><span>notas</span></a>
    </nav>


    <script src="treino.js"></script>
</body>
</html>
